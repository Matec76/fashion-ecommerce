<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>STYLEX | Bảng Điều Khiển</title>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        .content-area { flex-grow: 1; padding: 0; display: flex; flex-direction: column; }
        .topbar { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; background-color: white; border-bottom: 1px solid #ddd; }
        .topbar h2 { font-size: 24px; font-weight: 700; margin: 0; }
        .dashboard-body { padding: 40px; flex-grow: 1; overflow-y: auto; }
        
        .metric-cards-row { display: flex; gap: 20px; margin-bottom: 40px; }
        .card { background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
        .metric-card { flex: 1; display: flex; flex-direction: column; justify-content: space-between; height: 100px; }
        .metric-card p { color: #7f8c8d; font-size: 14px; margin: 0; }
        .metric-card strong { font-size: 28px; font-weight: 700; color: #0f1b2c; margin-top: 10px; }
        
        .main-stats-row { display: flex; gap: 20px; }
        .chart-panel { flex: 2; min-height: 400px; }
        .recent-activity-panel { flex: 1; min-height: 400px; }
        .chart-container { height: 320px; width: 100%; position: relative; }
        .activity-list { list-style: none; padding: 0; }
        .activity-list li { padding: 10px 0; border-bottom: 1px dashed #eee; font-size: 14px; }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="logo"><h1>STYLEX</h1></div>
        <nav class="main-menu">
            <ul>
                <li><a href="{{ url_for('auth.tongquan') }}" class="{{ 'active' if active_page == 'tongquan' else '' }}"><span class="material-symbols-outlined">home</span> Tổng quan</a></li>
                <li><a href="{{ url_for('sanpham.index') }}" class="{{ 'active' if active_page == 'sanpham' else '' }}"><span class="material-symbols-outlined">inventory_2</span> Sản phẩm</a></li>
                <li><a href="{{ url_for('donhang.index') }}" class="{{ 'active' if active_page == 'donhang' else '' }}"><span class="material-symbols-outlined">receipt_long</span> Đơn hàng</a></li>
                <li><a href="{{ url_for('khachhang.index') }}" class="{{ 'active' if active_page == 'khachhang' else '' }}"><span class="material-symbols-outlined">group</span> Khách hàng</a></li>
                <li><a href="{{ url_for('khac.marketing') }}" class="{{ 'active' if active_page == 'marketing' else '' }}"><span class="material-symbols-outlined">campaign</span> Marketing</a></li>
                <li><a href="{{ url_for('khac.noidung') }}" class="{{ 'active' if active_page == 'noidung' else '' }}"><span class="material-symbols-outlined">article</span> Nội dung</a></li>
                <li><a href="{{ url_for('khac.baocao') }}" class="{{ 'active' if active_page == 'baocao' else '' }}"><span class="material-symbols-outlined">bar_chart</span> Báo cáo</a></li>
                <li><a href="{{ url_for('khac.phanquyen') }}" class="{{ 'active' if active_page == 'cauhinh' else '' }}"><span class="material-symbols-outlined">settings</span> Cấu hình</a></li>
            </ul>
        </nav>
    </aside>

    <main class="content-area">
        <header class="topbar">
            <h2>Bảng điều khiển</h2>
            <div class="user-info">
                <span>Xin chào, Admin! | <a href="{{ url_for('auth.logout') }}">Thoát</a></span>
            </div>
        </header>

        <div class="dashboard-body">
            <section class="metric-cards-row">
                <div class="card metric-card">
                    <p>Tổng doanh thu</p>
                    <strong style="color: #27ae60;">{{ total_revenue | format_money }}</strong>
                </div>
                <div class="card metric-card">
                    <p>Đơn hàng</p>
                    <strong>{{ new_orders }}</strong>
                </div>
                <div class="card metric-card">
                    <p>Khách hàng</p>
                    <strong>{{ new_customers }}</strong>
                </div>
                <div class="card metric-card">
                    <p>Sản phẩm bán chạy</p>
                    <strong style="font-size: 20px;">Giày UltraBoost</strong>
                </div>
            </section>

            <section class="main-stats-row">
                <div class="card chart-panel">
                    <h3>Thống kê Doanh thu (Tháng này)</h3>
                    <div class="chart-container">
                        <canvas id="bieuDoDoanhThu"></canvas>
                    </div>
                </div>

                <div class="card recent-activity-panel">
                    <h3>Hoạt động gần đây</h3>
                    <ul class="activity-list">
                        <li>Đơn hàng <strong>#DH99382</strong> vừa được tạo.</li>
                        <li>Khách hàng <strong>Nguyễn Văn A</strong> vừa đăng ký.</li>
                        <li>Sản phẩm <strong>Áo Thun</strong> sắp hết hàng (5).</li>
                        <li>Đơn hàng <strong>#DH10293</strong> đã giao thành công.</li>
                    </ul>
                </div>
            </section>
        </div>
    </main>

    <script>
        const chartData = {{ data_doanh_thu | default([]) | tojson }};
        const chartLabels = {{ labels_ngay | default([]) | tojson }};
    </script>
    <script src="{{ url_for('static', filename='js/tongquan.js') }}"></script>
</body>
</html>